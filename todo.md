#TODO

#### 1. в папке src наладить запуск заполнения формул в фалйах Excel для

- [ ] bdrn.xls

```
python mxm.py bdrn.xls -M
python mxm.py bdrn.xls -U
```

- [ ] spec.xls

```
python mxm.py spec.xls -M
python mxm.py spec.xls -U
```

- [ ] spec1.xls

```
python mxm.py spec2.xls -M
python mxm.py spec2.xls -U
```

У меня на машине эти вызовы работают. 

#### 2. Добавить ref_file.xls 

- [ ]  наладить запуск python mxm.py ref_file.xls (не тестировалось)
    для этого надо шит 'result' переименовать в 'model' или изменить вызов mxm.py с [--sheet=<sheet>]

Ожидаемый результат: пишет формулы и не ругается.


#### 3. test_make_model.py 

придумать что делать с test_make_model.py - как он должна работать и что именно тестировать?

#### 4. Упростить структуру каталогов и файлов

- убрать test coverage
- удалить conftest.py, setup.cfg
- перенесети весь код в одноименную с репо папку ```make_xls_model``` (вместо src)
- в ней папки ```tests``` (юниттесты) и ```examples``` (все примеры использования с Excel файлами)
- пакет пока НЕ делаем
- стурктура файлов py - отделным вопросом
- еще что-то?


#### 5. Формализация тестов 
- [ ] дать описание формальных тестов  работы make-xls-model/src/make_xl_model.py
- [ ] после утверждения подхода реализовать тесты, желательно в py.test (предпочтительнее чем unittest)

#### 6. Рефакторинг кода 

Что в целом не пока нравится:
- структура папки src (папка с кодом должна быть одна)
- в коде make_xl_model.py немного перемешаны уровни абстракции
- зависимость от xlwings
- короткий, но уже сложный интерфейс командной строки
- недостаточно примеров использования
- тестируется что-то то тут, то там 
- плохо задокументировано (докстринги, )
- нечеткие связи со смежными репозитариями
 - [здесь](https://github.com/epogrebnyak/eqcell) должен быть пример ключевого алгоритма расстановки формул, но факту в репозитоарии [make-xls-model](https://github.com/epogrebnyak/make-xls-model/) он уже модифицирован. нужен своеобразный "backport" алгоритма и его интерфейса из ```make-xls-model``` в ```eqcell``` (одна версия кода и там и там должна получиться)
 - [здесь](https://github.com/epogrebnyak/roll-forward) выложен пример использования модели для прогнозирвания вперед с данными (закрытый репозитарий), но код очень сырой, непонятная структура папок
 
 #### 7. Найти модель, которая решалась в R
Их две, надо передалть формат файлов и добавить к примерам
<https://github.com/epogrebnyak/make-xls-model/issues/20>

Итого запускаемых примеров должно быть 6 или 7:

0.  bdrn.xls
0.  spec.xls (+ переименовать)
0.  spec1.xls (+ переименовать)
0.  файл на основе **test_make_model.py**   
0.  ref_file.xls 
0.  bm1_balance_model.xlsx
0.  bm2_value_only_bank_sector.xlsx
